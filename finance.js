const financeDataRevenuePgMatterYtd = [
  {
    name: 'TARGET ANNUAL',
    value: 650,
  },
  {
    name: 'TARGET YTD',
    value: 523,
  },
  {
    name: 'ACTUAL YTD',
    value: 401,
  },
];

const financeDataR1PgMatterYtd = [
  {
    name: 'TARGET ANNUAL',
    value: 350,
  },
  {
    name: 'TARGET YTD',
    value: 223,
  },
  {
    name: 'ACTUAL YTD',
    value: 101,
  },
];

const financeDataRevenuePgPicYtd = [
  {
    name: 'TARGET ANNUAL',
    value: 750,
  },
  {
    name: 'TARGET YTD',
    value: 550,
  },
  {
    name: 'ACTUAL YTD',
    value: 323,
  },
];

const financeDataRevenuePermonth = [
  {
    name: 'Jan',
    value: 6,
  },
  {
    name: 'Feb',
    value: 6,
  },
  {
    name: 'Mar',
    value: 2,
  },
  {
    name: 'Apr',
    value: 2,
  },
  {
    name: 'May',
    value: 2,
  },
  {
    name: 'Jun',
    value: 3,
  },
  {
    name: 'Jul',
    value: 2,
  },
  {
    name: 'Aug',
    value: 2,
  },
  {
    name: 'Sep',
    value: 0,
  },
  {
    name: 'Oct',
    value: 0,
  },

  {
    name: 'Nov',
    value: 0,
  },
  {
    name: 'Des',
    value: 0,
  },
];

const financeDataRonePermonth = [
  {
    name: 'Jan',
    value: 6,
  },
  {
    name: 'Feb',
    value: 6,
  },
  {
    name: 'Mar',
    value: 2,
  },
  {
    name: 'Apr',
    value: 2,
  },
  {
    name: 'May',
    value: 2,
  },
  {
    name: 'Jun',
    value: 3,
  },
  {
    name: 'Jul',
    value: 2,
  },
  {
    name: 'Aug',
    value: 2,
  },
  {
    name: 'Sep',
    value: 0,
  },
  {
    name: 'Oct',
    value: 0,
  },

  {
    name: 'Nov',
    value: 0,
  },
  {
    name: 'Des',
    value: 0,
  },
];

const financeDataR2YtdBilled = [
  {
    name: 'IDEAL',
    value: 39.5,
  },
  {
    name: 'ACTUAL YTD',
    value: 23.3,
  },
];

const financeDataR2YtdConfirmed = [
  {
    name: 'IDEAL',
    value: 39.9,
  },
  {
    name: 'ACTUAL YTD',
    value: 23.3,
  },
];

const financeDataR2YtdDifficult = [
  {
    name: 'IDEAL',
    value: 39.3,
  },
  {
    name: 'ACTUAL YTD',
    value: 23.3,
  },
];

const financeDataR2YtdOnProcess = [
  {
    name: 'IDEAL',
    value: 39.1,
  },
  {
    name: 'ACTUAL YTD',
    value: 23.3,
  },
];

const financeDataR3YtdWip = [
  {
    name: 'IDEAL',
    value: 39.3,
  },
  {
    name: 'ACTUAL YTD',
    value: 23.5,
  },
];

const financeDataRtwoPermonthBilled = [
  {
    name: 'Jan',
    value: 23.3,
  },
  {
    name: 'Feb',
    value: 23.3,
  },
  {
    name: 'Mar',
    value: 23.3,
  },
  {
    name: 'Apr',
    value: 23.3,
  },
  {
    name: 'May',
    value: 23.3,
  },
  {
    name: 'Jun',
    value: 23.3,
  },
  {
    name: 'Jul',
    value: 23.3,
  },
  {
    name: 'Aug',
    value: 2,
  },
  {
    name: 'Sep',
    value: 0,
  },
  {
    name: 'Oct',
    value: 0,
  },

  {
    name: 'Nov',
    value: 0,
  },
  {
    name: 'Des',
    value: 0,
  },
];

const financeDataRtwoPermonthConfirmed =
  [
    {
      name: 'Jan',
      value: 23.3,
    },
    {
      name: 'Feb',
      value: 23.3,
    },
    {
      name: 'Mar',
      value: 23.3,
    },
    {
      name: 'Apr',
      value: 23.3,
    },
    {
      name: 'May',
      value: 23.3,
    },
    {
      name: 'Jun',
      value: 23.3,
    },
    {
      name: 'Jul',
      value: 23.3,
    },
    {
      name: 'Aug',
      value: 2,
    },
    {
      name: 'Sep',
      value: 0,
    },
    {
      name: 'Oct',
      value: 0,
    },

    {
      name: 'Nov',
      value: 0,
    },
    {
      name: 'Des',
      value: 0,
    },
  ];

const financeDataRtwoPermonthDifficult =
  [
    {
      name: 'Jan',
      value: 23.3,
    },
    {
      name: 'Feb',
      value: 23.3,
    },
    {
      name: 'Mar',
      value: 23.3,
    },
    {
      name: 'Apr',
      value: 23.3,
    },
    {
      name: 'May',
      value: 33.3,
    },
    {
      name: 'Jun',
      value: 23.3,
    },
    {
      name: 'Jul',
      value: 43.3,
    },
    {
      name: 'Aug',
      value: 2,
    },
    {
      name: 'Sep',
      value: 0,
    },
    {
      name: 'Oct',
      value: 0,
    },

    {
      name: 'Nov',
      value: 0,
    },
    {
      name: 'Des',
      value: 0,
    },
  ];

const financeDataRtwoPeryear = [
  {
    name: 'TOTAL',
    value: 39.5,
  },
  {
    name: '2021',
    value: 23.3,
  },
  {
    name: '2020',
    value: 39.5,
  },
  {
    name: '2019',
    value: 39.5,
  },
  {
    name: '2018',
    value: 23.3,
  },
  {
    name: '< 2018',
    value: 23.3,
  },
];

const financeDataRthreePeryear = [
  {
    name: 'TOTAL',
    value: 39.5,
  },
  {
    name: '2021',
    value: 23.3,
  },
  {
    name: '2020',
    value: 39.5,
  },
  {
    name: '2019',
    value: 39.5,
  },
  {
    name: '2018',
    value: 23.3,
  },
  {
    name: '< 2018',
    value: 25.5,
  },
];

const financeDataRthreeStatusConfirmed =
  [
    {
      name: 'IDEAL',
      value: 35,
    },
    {
      name: 'ACTUAL YTD',
      value: 10,
    },
  ];

const financeDataRthreeStatusDifficult =
  [
    {
      name: 'IDEAL',
      value: 15,
    },
    {
      name: 'ACTUAL YTD',
      value: 10,
    },
  ];

const financeDataRthreeStatusOnProcess =
  [
    {
      name: 'IDEAL',
      value: 55,
    },
    {
      name: 'ACTUAL YTD',
      value: 90,
    },
  ];

const financeDataRthreeStatusNonPerforming =
  [
    {
      name: 'IDEAL',
      value: 0,
    },
    {
      name: 'ACTUAL YTD',
      value: 3,
    },
  ];

const financeDataRthreeStatusTotalPerChart =
  [
    {
      name: 'Total',
      value: 23.3,
    },
    {
      name: 'Confirmated',
      value: 5.3,
    },
    {
      name: 'Difficult',
      value: 13.3,
    },
    {
      name: 'On Process',
      value: 23.3,
    },
    {
      name: 'Non Performing',
      value: 11.3,
    },
  ];

//////////////// Bar Finance Revenue YTD \\\\\\\\\\\\\\\\\\\\\
const pFinanceRevenueYtd = d3
  .selectAll('.ChartFinance-revenueYtd')
  .append('svg')
  .attr('width', '150')
  .attr('height', 250);

const marginFinanceYtdRevenue = {
  top: 20,
  right: 0,
  bottom: 40,
  left: 0,
};
const graphWidthFinanceYtdRevenue =
  parseInt(
    pFinanceRevenueYtd.style('width')
  ) -
  marginFinanceYtdRevenue.left -
  marginFinanceYtdRevenue.right;

const graphHeightFinanceYtdRevenue =
  parseInt(
    pFinanceRevenueYtd.style('height')
  ) -
  marginFinanceYtdRevenue.top -
  marginFinanceYtdRevenue.bottom;

//pembuatan group
const graphFinanceYtdRevenue =
  pFinanceRevenueYtd
    .append('g')
    .attr(
      'width',
      graphWidthFinanceYtdRevenue
    )
    .attr(
      'height',
      graphHeightFinanceYtdRevenue
    )
    .attr(
      'transform',
      `translate(${marginFinanceYtdRevenue.left},${marginFinanceYtdRevenue.top})`
    );

const minFinanceYtdRevenue = d3.min(
  financeDataRevenuePgMatterYtd,
  (d) => d.value
); //method untuk mendapatkan nilai terkecil, dg callback function

const maxFinanceYtdRevenue = d3.max(
  financeDataRevenuePgMatterYtd,
  (d) => d.value
);

const xAxisGroupFinanceRevenueYtd =
  graphFinanceYtdRevenue
    .append('g')
    .attr(
      'transform',
      `translate(-1, ${
        graphHeightFinanceYtdRevenue -
        10
      })`
    )
    .attr('font-weight', 'bolder')
    .attr('color', 'grey');

//keterangan text dibawah
const yAxisGroupFinanceRevenueYtd =
  graphFinanceYtdRevenue.append('g');

const yFinanceYtdRevenue = d3
  .scaleLinear()
  .domain([
    -5,
    d3.max(
      financeDataRevenuePgMatterYtd,
      (d) => d.value
    ),
  ])
  .range([
    graphHeightFinanceYtdRevenue,
    0,
  ]);

const xFinanceYtdRevenue = d3
  .scaleBand()
  .domain(
    financeDataRevenuePgMatterYtd.map(
      (item) => item.name
    )
  )
  .range([
    0,
    graphWidthFinanceYtdRevenue,
  ])
  .paddingInner(0.2)
  .paddingOuter(0.2);

const rectsFinanceYtdRevenue =
  graphFinanceYtdRevenue
    .selectAll('rect')
    .data(
      financeDataRevenuePgMatterYtd
    );

rectsFinanceYtdRevenue
  .attr('width', 30)
  .attr(
    'height',
    (d) =>
      graphHeightFinanceYtdRevenue -
      yFinanceYtdRevenue(d.value)
  )
  .attr('fill', greenBar)
  .attr('x', (d) =>
    xFinanceYtdRevenue(d.name)
  )
  .attr('y', (d) =>
    yFinanceYtdRevenue(d.value)
  );

rectsFinanceYtdRevenue
  .enter()
  .append('rect')
  .attr('width', 40)
  .attr(
    'height',
    (d) =>
      graphHeightFinanceYtdRevenue -
      yFinanceYtdRevenue(d.value)
  )
  .attr('fill', (d) => {
    if (d.name == 'TARGET ANNUAL') {
      return '#98a0a8';
    } else if (d.name == 'TARGET YTD') {
      return 'darkblue';
    } else if (d.name == 'ACTUAL YTD') {
      return greenBar;
    }
  })
  .attr('x', (d) =>
    xFinanceYtdRevenue(d.name)
  )
  .attr('y', (d) =>
    yFinanceYtdRevenue(d.value)
  );

rectsFinanceYtdRevenue
  .enter()
  .append('text')
  .style('font-size', '11px')
  .text((d) => `${d.value}`)
  .attr('x', (d) =>
    xFinanceYtdRevenue(d.name)
  )
  .attr(
    'y',
    (d) =>
      yFinanceYtdRevenue(d.value) - 5
  )
  .attr(
    'transform',
    `translate(${15},${0})`
  )
  .attr('text-anchor', 'middle');

//create and call the axes
const xAxisFinanceYtdRevenue =
  d3.axisBottom(xFinanceYtdRevenue);

xAxisGroupFinanceRevenueYtd
  .call(xAxisFinanceYtdRevenue)
  .selectAll(
    '.ChartFinance-revenueYtd g.tick text'
  )
  .call(
    wrapYtdRevenue,
    xFinanceYtdRevenue.bandwidth()
  ); //call function wrapYtdRevenue

function wrapYtdRevenue(
  tester,
  graphWidthFinanceYtdRevenue
) {
  tester.each(function () {
    let text = d3.select(this),
      words = text
        .text()
        .split(/\s+/)
        .reverse(),
      word,
      line = [],
      lineNumber = 0,
      lineHeight = 1.1, // ems
      y = text.attr('y'),
      dy = parseFloat(text.attr('dy')),
      tspan = text
        .text(null)
        .append('tspan')
        .attr('x', 0)
        .attr('y', y)
        .attr('dy', dy + 'em');
    while ((word = words.pop())) {
      line.push(word);
      tspan.text(line.join(' '));
      if (
        tspan
          .node()
          .getComputedTextLength() >
        graphWidthFinanceYtdRevenue
      ) {
        line.pop();
        tspan.text(line.join(' '));
        line = [word];
        tspan = text
          .append('tspan')
          .attr('x', 0)
          .attr('y', y)
          .attr(
            'dy',
            ++lineNumber * lineHeight +
              dy +
              'em'
          )
          .text(word);
      }
    }
  });
}

xAxisGroupFinanceRevenueYtd
  .selectAll('line')
  .remove();

xAxisGroupFinanceRevenueYtd
  .select('.domain')
  .remove(); //remove path with class domain

//Wrap axisBottom text menjadi 2 baris

//////////////// Bar Finance Revenue Permonth \\\\\\\\\\\\\\\\\\\\\
const pFinanceRevenuePermonth = d3
  .selectAll(
    '.ChartFinance-revenuePermonth'
  )
  .append('svg')
  .attr('width', '470')
  .attr('height', 250);

const marginFinancePermonthRevenue = {
  top: 20,
  right: 0,
  bottom: 40,
  left: 0,
};
const graphWidthFinancePermonthRevenue =
  parseInt(
    pFinanceRevenuePermonth.style(
      'width'
    )
  ) -
  marginFinancePermonthRevenue.left -
  marginFinancePermonthRevenue.right;

const graphHeightFinancePermonthRevenue =
  parseInt(
    pFinanceRevenuePermonth.style(
      'height'
    )
  ) -
  marginFinancePermonthRevenue.top -
  marginFinancePermonthRevenue.bottom;

const graphFinancePermonthRevenue =
  pFinanceRevenuePermonth
    .append('g')
    .attr(
      'width',
      graphWidthFinancePermonthRevenue
    )
    .attr(
      'height',
      graphHeightFinancePermonthRevenue
    )
    .attr(
      'transform',
      `translate(${marginFinancePermonthRevenue.left},${marginFinancePermonthRevenue.top})`
    );

const minFinancePermonthRevenue =
  d3.min(
    financeDataRevenuePermonth,
    (d) => d.value
  );

const maxFinancePermonthRevenue =
  d3.max(
    financeDataRevenuePermonth,
    (d) => d.value
  );

const xAxisGroupFinanceRevenuePermonth =
  graphFinancePermonthRevenue
    .append('g')
    .attr(
      'transform',
      `translate(-7, ${graphHeightFinancePermonthRevenue})`
    );

const yAxisGroupFinanceRevenuePermonth =
  graphFinancePermonthRevenue.append(
    'g'
  );

const yFinancePermonthRevenue = d3
  .scaleLinear()
  .domain([
    -0.3,
    d3.max(
      financeDataRevenuePermonth,
      (d) => d.value
    ),
  ])
  .range([
    graphHeightFinancePermonthRevenue,
    0,
  ]);

const xFinancePermonthRevenue = d3
  .scaleBand()
  .domain(
    financeDataRevenuePermonth.map(
      (item) => item.name
    )
  )
  .range([
    0,
    graphWidthFinancePermonthRevenue,
  ])
  .paddingInner(0.2)
  .paddingOuter(0.2);

const rectsFinancePermonthRevenue =
  graphFinancePermonthRevenue
    .selectAll('rect')
    .data(financeDataRevenuePermonth);

rectsFinancePermonthRevenue
  .attr('width', 30)
  .attr(
    'height',
    (d) =>
      graphHeightFinancePermonthRevenue -
      yFinancePermonthRevenue(d.value)
  )
  .attr('fill', greenBar)
  .attr('x', (d) =>
    xFinancePermonthRevenue(d.name)
  )
  .attr('y', (d) =>
    yFinancePermonthRevenue(d.value)
  );

rectsFinancePermonthRevenue
  .enter()
  .append('rect')
  .attr('width', 25)
  .attr(
    'height',
    (d) =>
      graphHeightFinancePermonthRevenue -
      yFinancePermonthRevenue(d.value)
  )
  .attr('fill', 'darkblue')
  .attr('x', (d) =>
    xFinancePermonthRevenue(d.name)
  )
  .attr('y', (d) =>
    yFinancePermonthRevenue(d.value)
  );

rectsFinancePermonthRevenue
  .enter()
  .append('text')
  .style('font-size', '11px')
  .text((d) => `${d.value}`)
  .attr('x', (d) =>
    xFinancePermonthRevenue(d.name)
  )
  .attr(
    'y',
    (d) =>
      yFinancePermonthRevenue(d.value) -
      5
  )
  .attr(
    'transform',
    `translate(${15},${0})`
  )
  .attr('text-anchor', 'middle');

const xAxisFinancePermonthRevenue =
  d3.axisBottom(
    xFinancePermonthRevenue
  );

xAxisGroupFinanceRevenuePermonth.call(
  xAxisFinancePermonthRevenue
);

xAxisGroupFinanceRevenuePermonth
  .selectAll('line')
  .remove();

xAxisGroupFinanceRevenuePermonth
  .select('.domain')
  .remove(); //remove path with class domain

//////////////// Bar Finance R1 YTD \\\\\\\\\\\\\\\\\\\\\
const pFinanceROneYtd = d3
  .selectAll('.ChartFinance-rOneYtd')
  .append('svg')
  .attr('width', '150')
  .attr('height', 250);

const marginFinanceYtdROne = {
  top: 20,
  right: 0,
  bottom: 70,
  left: 0,
};
const graphWidthFinanceYtdROne =
  parseInt(
    pFinanceROneYtd.style('width')
  ) -
  marginFinanceYtdROne.left -
  marginFinanceYtdROne.right;

const graphHeightFinanceYtdROne =
  parseInt(
    pFinanceROneYtd.style('height')
  ) -
  marginFinanceYtdROne.top -
  marginFinanceYtdROne.bottom;

//pembuatan group
const graphFinanceYtdROne =
  pFinanceROneYtd
    .append('g')
    .attr(
      'width',
      graphWidthFinanceYtdROne
    )
    .attr(
      'height',
      graphHeightFinanceYtdROne
    )
    .attr(
      'transform',
      `translate(${marginFinanceYtdROne.left},${marginFinanceYtdROne.top})`
    );

const minFinanceYtdROne = d3.min(
  financeDataR1PgMatterYtd,
  (d) => d.value
); //method untuk mendapatkan nilai terkecil, dg callback function

const maxFinanceYtdROne = d3.max(
  financeDataR1PgMatterYtd,
  (d) => d.value
);

const xAxisGroupFinanceROneYtd =
  graphFinanceYtdROne
    .append('g')
    .attr(
      'transform',
      `translate(-1, ${
        graphHeightFinanceYtdROne - 10
      })`
    )
    .attr('font-weight', 'bolder')
    .attr('color', 'grey');

//keterangan text dibawah
const yAxisGroupFinanceROneYtd =
  graphFinanceYtdROne.append('g');

const yFinanceYtdROne = d3
  .scaleLinear()
  .domain([
    -5,
    d3.max(
      financeDataR1PgMatterYtd,
      (d) => d.value
    ),
  ])
  .range([
    graphHeightFinanceYtdROne,
    0,
  ]);

const xFinanceYtdROne = d3
  .scaleBand()
  .domain(
    financeDataR1PgMatterYtd.map(
      (item) => item.name
    )
  )
  .range([0, graphWidthFinanceYtdROne])
  .paddingInner(0.2)
  .paddingOuter(0.2);

const rectsFinanceYtdROne =
  graphFinanceYtdROne
    .selectAll('rect')
    .data(financeDataR1PgMatterYtd);

rectsFinanceYtdROne
  .attr('width', 30)
  .attr(
    'height',
    (d) =>
      graphHeightFinanceYtdROne -
      yFinanceYtdROne(d.value)
  )
  .attr('fill', greenBar)
  .attr('x', (d) =>
    xFinanceYtdROne(d.name)
  )
  .attr('y', (d) =>
    yFinanceYtdROne(d.value)
  );

rectsFinanceYtdROne
  .enter()
  .append('rect')
  .attr('width', 40)
  .attr(
    'height',
    (d) =>
      graphHeightFinanceYtdROne -
      yFinanceYtdROne(d.value)
  )
  .attr('fill', (d) => {
    if (d.name == 'TARGET ANNUAL') {
      return '#98a0a8';
    } else if (d.name == 'TARGET YTD') {
      return 'darkblue';
    } else if (d.name == 'ACTUAL YTD') {
      return greenBar;
    }
  })
  .attr('x', (d) =>
    xFinanceYtdROne(d.name)
  )
  .attr('y', (d) =>
    yFinanceYtdROne(d.value)
  );

rectsFinanceYtdROne
  .enter()
  .append('text')
  .style('font-size', '11px')
  .text((d) => `${d.value}`)
  .attr('x', (d) =>
    xFinanceYtdROne(d.name)
  )
  .attr(
    'y',
    (d) => yFinanceYtdROne(d.value) - 5
  )
  .attr(
    'transform',
    `translate(${15},${0})`
  )
  .attr('text-anchor', 'middle');

//create and call the axes
const xAxisFinanceYtdROne =
  d3.axisBottom(xFinanceYtdROne);

function wrapYtdROne(
  text,
  graphWidthFinanceYtdROne
) {
  text.each(function () {
    let text = d3.select(this),
      words = text
        .text()
        .split(/\s+/)
        .reverse(),
      word,
      line = [],
      lineNumber = 0,
      lineHeight = 1.1, // ems
      y = text.attr('y'),
      dy = parseFloat(text.attr('dy')),
      tspan = text
        .text(null)
        .append('tspan')
        .attr('x', 0)
        .attr('y', y)
        .attr('dy', dy + 'em');
    while ((word = words.pop())) {
      line.push(word);
      tspan.text(line.join(' '));
      if (
        tspan
          .node()
          .getComputedTextLength() >
        graphWidthFinanceYtdROne
      ) {
        line.pop();
        tspan.text(line.join(' '));
        line = [word];
        tspan = text
          .append('tspan')
          .attr('x', 0)
          .attr('y', y)
          .attr(
            'dy',
            ++lineNumber * lineHeight +
              dy +
              'em'
          )
          .text(word);
      }
    }
  });
}

xAxisGroupFinanceROneYtd
  .call(xAxisFinanceYtdROne)
  .selectAll(
    '.ChartFinance-rOneYtd.tick text'
  )
  .call(
    wrapYtdROne,
    xFinanceYtdROne.bandwidth()
  ); //call function wrapYtdROne

xAxisGroupFinanceROneYtd
  .selectAll('text')
  .attr(
    'transform',
    'rotate(-60) translate(-7, 7)'
  )
  .attr('font-size', 8)
  .attr('text-anchor', 'end');

xAxisGroupFinanceROneYtd
  .selectAll('line')
  .remove();

xAxisGroupFinanceROneYtd
  .select('.domain')
  .remove(); //remove path with class domain

//////////////// Bar Finance R1 Permonth \\\\\\\\\\\\\\\\\\\\\

const pFinanceRonePermonth = d3
  .selectAll(
    '.ChartFinance-rOnePermonth'
  )
  .append('svg')
  .attr('width', '470')
  .attr('height', 250);

const marginFinancePermonthROne = {
  top: 20,
  right: 0,
  bottom: 25,
  left: 0,
};
const graphWidthFinancePermonthROne =
  parseInt(
    pFinanceRonePermonth.style('width')
  ) -
  marginFinancePermonthROne.left -
  marginFinancePermonthROne.right;

const graphHeightFinancePermonthROne =
  parseInt(
    pFinanceRonePermonth.style('height')
  ) -
  marginFinancePermonthROne.top -
  marginFinancePermonthROne.bottom;

//pembuatan group
const graphFinancePermonthROne =
  pFinanceRonePermonth
    .append('g')
    .attr(
      'width',
      graphWidthFinancePermonthROne
    )
    .attr(
      'height',
      graphHeightFinancePermonthROne
    )
    .attr(
      'transform',
      `translate(${marginFinancePermonthROne.left},${marginFinancePermonthROne.top})`
    );

const minFinancePermonthROne = d3.min(
  financeDataRonePermonth,
  (d) => d.value
); //method untuk mendapatkan nilai terkecil, dg callback function

const maxFinancePermonthROne = d3.max(
  financeDataRonePermonth,
  (d) => d.value
);

const xAxisGroupFinanceRonePermonth =
  graphFinancePermonthROne
    .append('g')
    .attr(
      'transform',
      `translate(-7, ${graphHeightFinancePermonthROne})`
    ); //keterangan text dibawah

const yAxisGroupFinanceRonePermonth =
  graphFinancePermonthROne.append('g');

const yFinancePermonthROne = d3
  .scaleLinear()
  .domain([
    -0.3,
    d3.max(
      financeDataRonePermonth,
      (d) => d.value
    ),
  ])
  .range([
    graphHeightFinancePermonthROne,
    0,
  ]);

const xFinancePermonthROne = d3
  .scaleBand()
  .domain(
    financeDataRonePermonth.map(
      (item) => item.name
    )
  )
  .range([
    0,
    graphWidthFinancePermonthROne,
  ])
  .paddingInner(0.2)
  .paddingOuter(0.2);

const rectsFinancePermonthROne =
  graphFinancePermonthROne
    .selectAll('rect')
    .data(financeDataRonePermonth);

rectsFinancePermonthROne
  .attr('width', 30)
  .attr(
    'height',
    (d) =>
      graphHeightFinancePermonthROne -
      yFinancePermonthROne(d.value)
  )
  .attr('fill', greenBar)
  .attr('x', (d) =>
    xFinancePermonthROne(d.name)
  )
  .attr('y', (d) =>
    yFinancePermonthROne(d.value)
  );

rectsFinancePermonthROne
  .enter()
  .append('rect')
  .attr('width', 25)
  .attr(
    'height',
    (d) =>
      graphHeightFinancePermonthROne -
      yFinancePermonthROne(d.value)
  )
  .attr('fill', 'darkblue')
  .attr('x', (d) =>
    xFinancePermonthROne(d.name)
  )
  .attr('y', (d) =>
    yFinancePermonthROne(d.value)
  );

rectsFinancePermonthROne
  .enter()
  .append('text')
  .style('font-size', '11px')
  .text((d) => `${d.value}`)
  .attr('x', (d) =>
    xFinancePermonthROne(d.name)
  )
  .attr(
    'y',
    (d) =>
      yFinancePermonthROne(d.value) - 5
  )
  .attr(
    'transform',
    `translate(${15},${0})`
  )
  .attr('text-anchor', 'middle');

//create and call the axes
const xAxisFinancePermonthROne =
  d3.axisBottom(xFinancePermonthROne);

xAxisGroupFinanceRonePermonth.call(
  xAxisFinancePermonthROne
);

/* xAxisGroupFinanceRonePermonth
.selectAll("text")
.attr("fill", "lightgrey")
.attr(
    "transform",
    "rotate(-65) translate(1,3)"
)
.attr("font-size", "9px")
.attr("word-wrap", "break-word")
.style("font-weight", "bold")
.attr("text-anchor", "end"); */

xAxisGroupFinanceRonePermonth
  .selectAll('line')
  .remove();

xAxisGroupFinanceRonePermonth
  .select('.domain')
  .remove(); //remove path with class domain

//////////////// Bar Finance R2 YTD \\\\\\\\\\\\\\\\\\\\\
// diganti dengan function

//////////////// Bar Finance R2 Peryear \\\\\\\\\\\\\\\\\\\\\

//////////////// Bar Finance R3 Peryear \\\\\\\\\\\\\\\\\\\\\

//////////////// Bar Finance R3 Status Confirmed \\\\\\\\\\\\\\\\\\\\\

//////////////// Bar Finance R3 Status Difficult \\\\\\\\\\\\\\\\\\\\\

//////////////// Bar Finance R3 Status On Process \\\\\\\\\\\\\\\\\\\\\

//////////////// Bar Finance R3 Status Non Performing \\\\\\\\\\\\\\\\\\\\\

//////////////// Bar Finance R3 Status Total PerChart \\\\\\\\\\\\\\\\\\\\\

////////////// Chart Finance R2 Ytd \\\\\\\\\\\\
function createChartFinanceYtd(
  data,
  namaKelas
) {
  const pFinanceRTwoYtd = d3
    .selectAll(`.${namaKelas}`)
    .append('svg')
    .attr('width', '170')
    .attr('height', 150);

  const marginFinanceYtdRTwo = {
    top: 20,
    right: 0,
    bottom: 20,
    left: 0,
  };
  const graphWidthFinanceYtdRTwo =
    parseInt(
      pFinanceRTwoYtd.style('width')
    ) -
    marginFinanceYtdRTwo.left -
    marginFinanceYtdRTwo.right;

  const graphHeightFinanceYtdRTwo =
    parseInt(
      pFinanceRTwoYtd.style('height')
    ) -
    marginFinanceYtdRTwo.top -
    marginFinanceYtdRTwo.bottom;

  //pembuatan group
  const graphFinanceYtdRTwo =
    pFinanceRTwoYtd
      .append('g')
      .attr(
        'width',
        graphWidthFinanceYtdRTwo
      )
      .attr(
        'height',
        graphHeightFinanceYtdRTwo
      )
      .attr(
        'transform',
        `translate(${marginFinanceYtdRTwo.left},${marginFinanceYtdRTwo.top})`
      );

  const minFinanceYtdRTwo = d3.min(
    data,
    (d) => d.value
  ); //method untuk mendapatkan nilai terkecil, dg callback function

  const maxFinanceYtdRTwo = d3.max(
    data,
    (d) => d.value
  );

  const xAxisGroupFinanceRTwoYtd =
    graphFinanceYtdRTwo
      .append('g')
      .attr(
        'transform',
        `translate(-1, ${graphHeightFinanceYtdRTwo})`
      )
      .attr('font-weight', 'bolder')
      .attr('color', 'grey');

  //keterangan text dibawah
  const yAxisGroupFinanceRTwoYtd =
    graphFinanceYtdRTwo.append('g');

  const yFinanceYtdRTwo = d3
    .scaleLinear()
    .domain([
      -5,
      d3.max(data, (d) => d.value),
    ])
    .range([
      graphHeightFinanceYtdRTwo,
      0,
    ]);

  const xFinanceYtdRTwo = d3
    .scaleBand()
    .domain(
      data.map((item) => item.name)
    )
    .range([
      0,
      graphWidthFinanceYtdRTwo,
    ])
    .paddingInner(0.2)
    .paddingOuter(0.2);

  const rectsFinanceYtdRTwo =
    graphFinanceYtdRTwo
      .selectAll('rect')
      .data(data);

  rectsFinanceYtdRTwo
    .attr('width', 65)
    .attr(
      'height',
      (d) =>
        graphHeightFinanceYtdRTwo -
        yFinanceYtdRTwo(d.value)
    )
    .attr('fill', greenBar)
    .attr('x', (d) =>
      xFinanceYtdRTwo(d.name)
    )
    .attr('y', (d) =>
      yFinanceYtdRTwo(d.value)
    );

  rectsFinanceYtdRTwo
    .enter()
    .append('rect')
    .attr('width', 65)
    .attr(
      'height',
      (d) =>
        graphHeightFinanceYtdRTwo -
        yFinanceYtdRTwo(d.value)
    )
    .attr('fill', (d) => {
      if (d.name == 'IDEAL') {
        return 'darkblue';
      } else {
        return greenBar;
      }
    })
    .attr('x', (d) =>
      xFinanceYtdRTwo(d.name)
    )
    .attr('y', (d) =>
      yFinanceYtdRTwo(d.value)
    );

  rectsFinanceYtdRTwo
    .enter()
    .append('text')
    .style('font-size', '11px')
    .text((d) => `${d.value}`)
    .attr('x', (d) =>
      xFinanceYtdRTwo(d.name)
    )
    .attr(
      'y',
      (d) =>
        yFinanceYtdRTwo(d.value) - 5
    )
    .attr(
      'transform',
      `translate(${30},${0})`
    )
    .attr('text-anchor', 'middle');

  //create and call the axes
  const xAxisFinanceYtdRTwo =
    d3.axisBottom(xFinanceYtdRTwo);

  function wrapYtdRTwo(
    text,
    graphWidthFinanceYtdRTwo
  ) {
    text.each(function () {
      let text = d3.select(this),
        words = text
          .text()
          .split(/\s+/)
          .reverse(),
        word,
        line = [],
        lineNumber = 0,
        lineHeight = 1.1, // ems
        y = text.attr('y'),
        dy = parseFloat(
          text.attr('dy')
        ),
        tspan = text
          .text(null)
          .append('tspan')
          .attr('x', 0)
          .attr('y', y)
          .attr('dy', dy + 'em');
      while ((word = words.pop())) {
        line.push(word);
        tspan.text(line.join(' '));
        if (
          tspan
            .node()
            .getComputedTextLength() >
          graphWidthFinanceYtdRTwo
        ) {
          line.pop();
          tspan.text(line.join(' '));
          line = [word];
          tspan = text
            .append('tspan')
            .attr('x', 0)
            .attr('y', y)
            .attr(
              'dy',
              ++lineNumber *
                lineHeight +
                dy +
                'em'
            )
            .text(word);
        }
      }
    });
  }

  xAxisGroupFinanceRTwoYtd
    .call(xAxisFinanceYtdRTwo)
    .selectAll(
      '.ChartFinance-rTwoYtd.tick text'
    )
    .call(
      wrapYtdRTwo,
      xFinanceYtdRTwo.bandwidth()
    ); //call function wrapYtdRTwo

  xAxisGroupFinanceRTwoYtd
    .selectAll('text')
    .attr('font-size', 9)
    .attr('text-anchor', 'middle');
  // rotate text axis

  xAxisGroupFinanceRTwoYtd
    .selectAll('line')
    .remove();

  xAxisGroupFinanceRTwoYtd
    .select('.domain')
    .remove(); //remove path with class domain
}

const chartFinanceR2YtdBilled =
  createChartFinanceYtd(
    financeDataR2YtdBilled,
    'ChartFinance-R2YtdBilled'
  );
const chartFinanceR2YtdConfirmed =
  createChartFinanceYtd(
    financeDataR2YtdConfirmed,
    'ChartFinance-R2YtdConfirmed'
  );
const chartFinanceR2YtdDifficult =
  createChartFinanceYtd(
    financeDataR2YtdDifficult,
    'ChartFinance-R2YtdDifficult'
  );
const chartFinanceR2YtdOnProcess =
  createChartFinanceYtd(
    financeDataR2YtdOnProcess,
    'ChartFinance-R2YtdOnProcess'
  );

const chartFinanceR3YtdWip =
  createChartFinanceYtd(
    financeDataR3YtdWip,
    'ChartFinance-R3YtdWip'
  );

////////////// Chart Finance R2 Perbulan
function createChartFinancePerBulan(
  data,
  namaKelas
) {
  const pFinanceRevenuePermonth = d3
    .selectAll(`.${namaKelas}`)
    .append('svg')
    .attr('width', '770')
    .attr('height', 150);

  const marginFinancePermonthRevenue = {
    top: 20,
    right: 0,
    bottom: 20,
    left: 0,
  };
  const graphWidthFinancePermonthRevenue =
    parseInt(
      pFinanceRevenuePermonth.style(
        'width'
      )
    ) -
    marginFinancePermonthRevenue.left -
    marginFinancePermonthRevenue.right;

  const graphHeightFinancePermonthRevenue =
    parseInt(
      pFinanceRevenuePermonth.style(
        'height'
      )
    ) -
    marginFinancePermonthRevenue.top -
    marginFinancePermonthRevenue.bottom;

  //pembuatan group
  const graphFinancePermonthRevenue =
    pFinanceRevenuePermonth
      .append('g')
      .attr(
        'width',
        graphWidthFinancePermonthRevenue
      )
      .attr(
        'height',
        graphHeightFinancePermonthRevenue
      )
      .attr(
        'transform',
        `translate(${marginFinancePermonthRevenue.left},${marginFinancePermonthRevenue.top})`
      );

  const minFinancePermonthRevenue =
    d3.min(data, (d) => d.value); //method untuk mendapatkan nilai terkecil, dg callback function

  const maxFinancePermonthRevenue =
    d3.max(data, (d) => d.value);

  const xAxisGroupFinanceRevenuePermonth =
    graphFinancePermonthRevenue
      .append('g')
      .attr(
        'transform',
        `translate(-7, ${graphHeightFinancePermonthRevenue})`
      ); //keterangan text dibawah

  const yAxisGroupFinanceRevenuePermonth =
    graphFinancePermonthRevenue.append(
      'g'
    );

  const yFinancePermonthRevenue = d3
    .scaleLinear()
    .domain([
      -0.3,
      d3.max(data, (d) => d.value),
    ])
    .range([
      graphHeightFinancePermonthRevenue,
      0,
    ]);

  const xFinancePermonthRevenue = d3
    .scaleBand()
    .domain(
      data.map((item) => item.name)
    )
    .range([
      0,
      graphWidthFinancePermonthRevenue,
    ])
    .paddingInner(0.2)
    .paddingOuter(0.2);

  const rectsFinancePermonthRevenue =
    graphFinancePermonthRevenue
      .selectAll('rect')
      .data(data);

  rectsFinancePermonthRevenue
    .attr('width', 55)
    .attr(
      'height',
      (d) =>
        graphHeightFinancePermonthRevenue -
        yFinancePermonthRevenue(d.value)
    )
    .attr('fill', greenBar)
    .attr('x', (d) =>
      xFinancePermonthRevenue(d.name)
    )
    .attr('y', (d) =>
      yFinancePermonthRevenue(d.value)
    );

  rectsFinancePermonthRevenue
    .enter()
    .append('rect')
    .attr('width', 55)
    .attr(
      'height',
      (d) =>
        graphHeightFinancePermonthRevenue -
        yFinancePermonthRevenue(d.value)
    )
    .attr('fill', greenBar)
    .attr('x', (d) =>
      xFinancePermonthRevenue(d.name)
    )
    .attr('y', (d) =>
      yFinancePermonthRevenue(d.value)
    );

  rectsFinancePermonthRevenue
    .enter()
    .append('text')
    .style('font-size', '11px')
    .text((d) => `${d.value}`)
    .attr('x', (d) =>
      xFinancePermonthRevenue(d.name)
    )
    .attr(
      'y',
      (d) =>
        yFinancePermonthRevenue(
          d.value
        ) - 5
    )
    .attr(
      'transform',
      `translate(${15},${0})`
    )
    .attr('text-anchor', 'middle');

  //create and call the axes
  const xAxisFinancePermonthRevenue =
    d3.axisBottom(
      xFinancePermonthRevenue
    );

  xAxisGroupFinanceRevenuePermonth.call(
    xAxisFinancePermonthRevenue
  );

  /* xAxisGroupFinanceRevenuePermonth
.selectAll("text")
.attr("fill", "lightgrey")
.attr(
    "transform",
    "rotate(-65) translate(1,3)"
)
.attr("font-size", "9px")
.attr("word-wrap", "break-word")
.style("font-weight", "bold")
.attr("text-anchor", "end"); */

  xAxisGroupFinanceRevenuePermonth
    .selectAll('line')
    .remove();

  xAxisGroupFinanceRevenuePermonth
    .select('.domain')
    .remove(); //remove path with class domain
}

const chartFinanceForR2Billed =
  createChartFinancePerBulan(
    financeDataRtwoPermonthBilled,
    'ChartFinance-R2PerbulanBilled'
  );

const chartFinanceForR2Confirmed =
  createChartFinancePerBulan(
    financeDataRtwoPermonthConfirmed,
    'ChartFinance-R2PerbulanConfirmed'
  );

const chartFinanceForR2Difficult =
  createChartFinancePerBulan(
    financeDataRtwoPermonthDifficult,
    'ChartFinance-R2PerbulanDifficult'
  );

const chartFinanceForRThreeWip =
  createChartFinancePerBulan(
    financeDataRtwoPermonthDifficult,
    'ChartFinance-R3PerbulanWip'
  );

function CreateChartFinanceNonPerforming(
  data,
  namaClass
) {
  const pFinanceRTwoPeryear = d3
    .selectAll(`.${namaClass}`)
    .append('svg')
    .attr('width', '500')
    .attr('height', 150);

  const marginFinancePeryearRTwo = {
    top: 20,
    right: 0,
    bottom: 20,
    left: 0,
  };
  const graphWidthFinancePeryearRTwo =
    parseInt(
      pFinanceRTwoPeryear.style('width')
    ) -
    marginFinancePeryearRTwo.left -
    marginFinancePeryearRTwo.right;

  const graphHeightFinancePeryearRTwo =
    parseInt(
      pFinanceRTwoPeryear.style(
        'height'
      )
    ) -
    marginFinancePeryearRTwo.top -
    marginFinancePeryearRTwo.bottom;

  //pembuatan group
  const graphFinancePeryearRTwo =
    pFinanceRTwoPeryear
      .append('g')
      .attr(
        'width',
        graphWidthFinancePeryearRTwo
      )
      .attr(
        'height',
        graphHeightFinancePeryearRTwo
      )
      .attr(
        'transform',
        `translate(${marginFinancePeryearRTwo.left},${marginFinancePeryearRTwo.top})`
      );

  const minFinancePeryearRTwo = d3.min(
    data,
    (d) => d.value
  ); //method untuk mendapatkan nilai terkecil, dg callback function

  const maxFinancePeryearRTwo = d3.max(
    data,
    (d) => d.value
  );

  const xAxisGroupFinanceRTwoPeryear =
    graphFinancePeryearRTwo
      .append('g')
      .attr(
        'transform',
        `translate(-2, ${graphHeightFinancePeryearRTwo})`
      )
      .attr('font-weight', 'bolder')
      .attr('color', 'grey');

  //keterangan text dibawah
  const yAxisGroupFinanceRTwoPeryear =
    graphFinancePeryearRTwo.append('g');

  const yFinancePeryearRTwo = d3
    .scaleLinear()
    .domain([
      -5,
      d3.max(data, (d) => d.value),
    ])
    .range([
      graphHeightFinancePeryearRTwo,
      0,
    ]);

  const xFinancePeryearRTwo = d3
    .scaleBand()
    .domain(
      data.map((item) => item.name)
    )
    .range([
      0,
      graphWidthFinancePeryearRTwo,
    ])
    .paddingInner(0.2)
    .paddingOuter(0.2);

  const rectsFinancePeryearRTwo =
    graphFinancePeryearRTwo
      .selectAll('rect')
      .data(data);

  rectsFinancePeryearRTwo
    .attr('width', 65)
    .attr(
      'height',
      (d) =>
        graphHeightFinancePeryearRTwo -
        yFinancePeryearRTwo(d.value)
    )
    .attr('fill', greenBar)
    .attr('x', (d) =>
      xFinancePeryearRTwo(d.name)
    )
    .attr('y', (d) =>
      yFinancePeryearRTwo(d.value)
    );

  rectsFinancePeryearRTwo
    .enter()
    .append('rect')
    .attr('width', 65)
    .attr(
      'height',
      (d) =>
        graphHeightFinancePeryearRTwo -
        yFinancePeryearRTwo(d.value)
    )
    .attr('fill', greenBar)
    .attr('x', (d) =>
      xFinancePeryearRTwo(d.name)
    )
    .attr('y', (d) =>
      yFinancePeryearRTwo(d.value)
    );

  rectsFinancePeryearRTwo
    .enter()
    .append('text')
    .style('font-size', '11px')
    .text((d) => `${d.value}`)
    .attr('x', (d) =>
      xFinancePeryearRTwo(d.name)
    )
    .attr(
      'y',
      (d) =>
        yFinancePeryearRTwo(d.value) - 5
    )
    .attr(
      'transform',
      `translate(${25},${0})`
    )
    .attr('text-anchor', 'middle');

  //create and call the axes
  const xAxisFinancePeryearRTwo =
    d3.axisBottom(xFinancePeryearRTwo);

  function wrapPeryearRTwo(
    text,
    graphWidthFinancePeryearRTwo
  ) {
    text.each(function () {
      let text = d3.select(this),
        words = text
          .text()
          .split(/\s+/)
          .reverse(),
        word,
        line = [],
        lineNumber = 0,
        lineHeight = 1.1, // ems
        y = text.attr('y'),
        dy = parseFloat(
          text.attr('dy')
        ),
        tspan = text
          .text(null)
          .append('tspan')
          .attr('x', 0)
          .attr('y', y)
          .attr('dy', dy + 'em');
      while ((word = words.pop())) {
        line.push(word);
        tspan.text(line.join(' '));
        if (
          tspan
            .node()
            .getComputedTextLength() >
          graphWidthFinancePeryearRTwo
        ) {
          line.pop();
          tspan.text(line.join(' '));
          line = [word];
          tspan = text
            .append('tspan')
            .attr('x', 0)
            .attr('y', y)
            .attr(
              'dy',
              ++lineNumber *
                lineHeight +
                dy +
                'em'
            )
            .text(word);
        }
      }
    });
  }

  xAxisGroupFinanceRTwoPeryear
    .call(xAxisFinancePeryearRTwo)
    .selectAll(
      '.ChartFinance-rTwoYtd.tick text'
    )
    .call(
      wrapPeryearRTwo,
      xFinancePeryearRTwo.bandwidth()
    ); //call function wrapPeryearRTwo

  /* xAxisGroupFinanceRTwoPeryear
  .selectAll("text")
  .attr(
      "transform",
      "rotate(-60) translate(-7, 7)"
  )
  .attr("font-size", 8)
  .attr("text-anchor", "end"); */
  // rotate text axis

  xAxisGroupFinanceRTwoPeryear
    .selectAll('line')
    .remove();

  xAxisGroupFinanceRTwoPeryear
    .select('.domain')
    .remove(); //remove path with class domain
}

const buatChartFinanceNonPerforming =
  CreateChartFinanceNonPerforming(
    financeDataRtwoPeryear,
    'ChartFinance-R2NonPerforming'
  );

function CreateChartFinanceR3Year(
  data,
  namaClass
) {
  const pFinanceRThreePeryear = d3
    .selectAll(`.${namaClass}`)
    .append('svg')
    .attr('width', '500')
    .attr('height', 150);

  const marginFinancePeryearRThree = {
    top: 20,
    right: 0,
    bottom: 20,
    left: 0,
  };
  const graphWidthFinancePeryearRThree =
    parseInt(
      pFinanceRThreePeryear.style(
        'width'
      )
    ) -
    marginFinancePeryearRThree.left -
    marginFinancePeryearRThree.right;

  const graphHeightFinancePeryearRThree =
    parseInt(
      pFinanceRThreePeryear.style(
        'height'
      )
    ) -
    marginFinancePeryearRThree.top -
    marginFinancePeryearRThree.bottom;

  //pembuatan group
  const graphFinancePeryearRThree =
    pFinanceRThreePeryear
      .append('g')
      .attr(
        'width',
        graphWidthFinancePeryearRThree
      )
      .attr(
        'height',
        graphHeightFinancePeryearRThree
      )
      .attr(
        'transform',
        `translate(${marginFinancePeryearRThree.left},${marginFinancePeryearRThree.top})`
      );

  const minFinancePeryearRThree =
    d3.min(data, (d) => d.value); //method untuk mendapatkan nilai terkecil, dg callback function

  const maxFinancePeryearRThree =
    d3.max(data, (d) => d.value);

  const xAxisGroupFinanceRThreePeryear =
    graphFinancePeryearRThree
      .append('g')
      .attr(
        'transform',
        `translate(-1, ${graphHeightFinancePeryearRThree})`
      )
      .attr('font-weight', 'bolder')
      .attr('color', 'grey');

  //keterangan text dibawah
  const yAxisGroupFinanceRThreePeryear =
    graphFinancePeryearRThree.append(
      'g'
    );

  const yFinancePeryearRThree = d3
    .scaleLinear()
    .domain([
      -5,
      d3.max(data, (d) => d.value),
    ])
    .range([
      graphHeightFinancePeryearRThree,
      0,
    ]);

  const xFinancePeryearRThree = d3
    .scaleBand()
    .domain(
      data.map((item) => item.name)
    )
    .range([
      0,
      graphWidthFinancePeryearRThree,
    ])
    .paddingInner(0.2)
    .paddingOuter(0.2);

  const rectsFinancePeryearRThree =
    graphFinancePeryearRThree
      .selectAll('rect')
      .data(data);

  rectsFinancePeryearRThree
    .attr('width', 65)
    .attr(
      'height',
      (d) =>
        graphHeightFinancePeryearRThree -
        yFinancePeryearRThree(d.value)
    )
    .attr('fill', greenBar)
    .attr('x', (d) =>
      xFinancePeryearRThree(d.name)
    )
    .attr('y', (d) =>
      yFinancePeryearRThree(d.value)
    );

  rectsFinancePeryearRThree
    .enter()
    .append('rect')
    .attr('width', 65)
    .attr(
      'height',
      (d) =>
        graphHeightFinancePeryearRThree -
        yFinancePeryearRThree(d.value)
    )
    .attr('fill', (d) => {
      if (d.name == 'TOTAL') {
        return 'darkblue';
      } else {
        return greenBar;
      }
    })
    .attr('x', (d) =>
      xFinancePeryearRThree(d.name)
    )
    .attr('y', (d) =>
      yFinancePeryearRThree(d.value)
    );

  rectsFinancePeryearRThree
    .enter()
    .append('text')
    .style('font-size', '11px')
    .text((d) => `${d.value}%`)
    .attr('x', (d) =>
      xFinancePeryearRThree(d.name)
    )
    .attr(
      'y',
      (d) =>
        yFinancePeryearRThree(d.value) -
        5
    )
    .attr(
      'transform',
      `translate(${30},${0})`
    )
    .attr('text-anchor', 'middle');

  //create and call the axes
  const xAxisFinancePeryearRThree =
    d3.axisBottom(
      xFinancePeryearRThree
    );

  function wrapPeryearRThree(
    text,
    graphWidthFinancePeryearRThree
  ) {
    text.each(function () {
      let text = d3.select(this),
        words = text
          .text()
          .split(/\s+/)
          .reverse(),
        word,
        line = [],
        lineNumber = 0,
        lineHeight = 1.1, // ems
        y = text.attr('y'),
        dy = parseFloat(
          text.attr('dy')
        ),
        tspan = text
          .text(null)
          .append('tspan')
          .attr('x', 0)
          .attr('y', y)
          .attr('dy', dy + 'em');
      while ((word = words.pop())) {
        line.push(word);
        tspan.text(line.join(' '));
        if (
          tspan
            .node()
            .getComputedTextLength() >
          graphWidthFinancePeryearRThree
        ) {
          line.pop();
          tspan.text(line.join(' '));
          line = [word];
          tspan = text
            .append('tspan')
            .attr('x', 0)
            .attr('y', y)
            .attr(
              'dy',
              ++lineNumber *
                lineHeight +
                dy +
                'em'
            )
            .text(word);
        }
      }
    });
  }

  xAxisGroupFinanceRThreePeryear
    .call(xAxisFinancePeryearRThree)
    .selectAll(
      '.ChartFinance-rTwoYtd.tick text'
    )
    .call(
      wrapPeryearRThree,
      xFinancePeryearRThree.bandwidth()
    ); //call function wrapPeryearRThree

  /* xAxisGroupFinanceRThreePeryear
  .selectAll("text")
  .attr(
      "transform",
      "rotate(-60) translate(-7, 7)"
  )
  .attr("font-size", 8)
  .attr("text-anchor", "end"); */
  // rotate text axis

  xAxisGroupFinanceRThreePeryear
    .selectAll('line')
    .remove();

  xAxisGroupFinanceRThreePeryear
    .select('.domain')
    .remove(); //remove path with class domain
}

const buatChartFinanceR3Year =
  CreateChartFinanceR3Year(
    financeDataRthreePeryear,
    'ChartFinance-R3Year'
  );

function createChartFinanceYtdStatus(
  data,
  namaKelas
) {
  const pFinanceRTwoYtd = d3
    .selectAll(`.${namaKelas}`)
    .append('svg')
    .attr('width', '120')
    .attr('height', 150);

  const marginFinanceYtdRTwo = {
    top: 20,
    right: 0,
    bottom: 20,
    left: 0,
  };
  const graphWidthFinanceYtdRTwo =
    parseInt(
      pFinanceRTwoYtd.style('width')
    ) -
    marginFinanceYtdRTwo.left -
    marginFinanceYtdRTwo.right;

  const graphHeightFinanceYtdRTwo =
    parseInt(
      pFinanceRTwoYtd.style('height')
    ) -
    marginFinanceYtdRTwo.top -
    marginFinanceYtdRTwo.bottom;

  //pembuatan group
  const graphFinanceYtdRTwo =
    pFinanceRTwoYtd
      .append('g')
      .attr(
        'width',
        graphWidthFinanceYtdRTwo
      )
      .attr(
        'height',
        graphHeightFinanceYtdRTwo
      )
      .attr(
        'transform',
        `translate(${marginFinanceYtdRTwo.left},${marginFinanceYtdRTwo.top})`
      );

  const minFinanceYtdRTwo = d3.min(
    data,
    (d) => d.value
  ); //method untuk mendapatkan nilai terkecil, dg callback function

  const maxFinanceYtdRTwo = d3.max(
    data,
    (d) => d.value
  );

  const xAxisGroupFinanceRTwoYtd =
    graphFinanceYtdRTwo
      .append('g')
      .attr(
        'transform',
        `translate(-1, ${graphHeightFinanceYtdRTwo})`
      )
      .attr('font-weight', 'bolder')
      .attr('color', 'grey');

  //keterangan text dibawah
  const yAxisGroupFinanceRTwoYtd =
    graphFinanceYtdRTwo.append('g');

  const yFinanceYtdRTwo = d3
    .scaleLinear()
    .domain([
      -5,
      d3.max(data, (d) => d.value),
    ])
    .range([
      graphHeightFinanceYtdRTwo,
      0,
    ]);

  const xFinanceYtdRTwo = d3
    .scaleBand()
    .domain(
      data.map((item) => item.name)
    )
    .range([
      0,
      graphWidthFinanceYtdRTwo,
    ])
    .paddingInner(0.2)
    .paddingOuter(0.2);

  const rectsFinanceYtdRTwo =
    graphFinanceYtdRTwo
      .selectAll('rect')
      .data(data);

  rectsFinanceYtdRTwo
    .attr('width', 45)
    .attr(
      'height',
      (d) =>
        graphHeightFinanceYtdRTwo -
        yFinanceYtdRTwo(d.value)
    )
    .attr('fill', greenBar)
    .attr('x', (d) =>
      xFinanceYtdRTwo(d.name)
    )
    .attr('y', (d) =>
      yFinanceYtdRTwo(d.value)
    );

  rectsFinanceYtdRTwo
    .enter()
    .append('rect')
    .attr('width', 45)
    .attr(
      'height',
      (d) =>
        graphHeightFinanceYtdRTwo -
        yFinanceYtdRTwo(d.value)
    )
    .attr('fill', (d) => {
      if (d.name == 'IDEAL') {
        return 'darkblue';
      } else {
        return greenBar;
      }
    })
    .attr('x', (d) =>
      xFinanceYtdRTwo(d.name)
    )
    .attr('y', (d) =>
      yFinanceYtdRTwo(d.value)
    );

  rectsFinanceYtdRTwo
    .enter()
    .append('text')
    .style('font-size', '11px')
    .text((d) => `${d.value}`)
    .attr('x', (d) =>
      xFinanceYtdRTwo(d.name)
    )
    .attr(
      'y',
      (d) =>
        yFinanceYtdRTwo(d.value) - 5
    )
    .attr(
      'transform',
      `translate(${30},${0})`
    )
    .attr('text-anchor', 'middle');

  //create and call the axes
  const xAxisFinanceYtdRTwo =
    d3.axisBottom(xFinanceYtdRTwo);

  function wrapYtdRTwo(
    text,
    graphWidthFinanceYtdRTwo
  ) {
    text.each(function () {
      let text = d3.select(this),
        words = text
          .text()
          .split(/\s+/)
          .reverse(),
        word,
        line = [],
        lineNumber = 0,
        lineHeight = 1.1, // ems
        y = text.attr('y'),
        dy = parseFloat(
          text.attr('dy')
        ),
        tspan = text
          .text(null)
          .append('tspan')
          .attr('x', 0)
          .attr('y', y)
          .attr('dy', dy + 'em');
      while ((word = words.pop())) {
        line.push(word);
        tspan.text(line.join(' '));
        if (
          tspan
            .node()
            .getComputedTextLength() >
          graphWidthFinanceYtdRTwo
        ) {
          line.pop();
          tspan.text(line.join(' '));
          line = [word];
          tspan = text
            .append('tspan')
            .attr('x', 0)
            .attr('y', y)
            .attr(
              'dy',
              ++lineNumber *
                lineHeight +
                dy +
                'em'
            )
            .text(word);
        }
      }
    });
  }

  xAxisGroupFinanceRTwoYtd
    .call(xAxisFinanceYtdRTwo)
    .selectAll(
      '.ChartFinance-rTwoYtd.tick text'
    )
    .call(
      wrapYtdRTwo,
      xFinanceYtdRTwo.bandwidth()
    ); //call function wrapYtdRTwo

  xAxisGroupFinanceRTwoYtd
    .selectAll('text')
    .attr('font-size', 9)
    .attr('text-anchor', 'middle');
  // rotate text axis

  xAxisGroupFinanceRTwoYtd
    .selectAll('line')
    .remove();

  xAxisGroupFinanceRTwoYtd
    .select('.domain')
    .remove(); //remove path with class domain
}

const chartFinanceR3YtdStatusConfirmed =
  createChartFinanceYtdStatus(
    financeDataR3YtdWip,
    'ChartFinance-R3StatusConfirmed'
  );

const chartFinanceR3YtdStatusDifficult =
  createChartFinanceYtdStatus(
    financeDataR3YtdWip,
    'ChartFinance-R3StatusDifficult'
  );

const chartFinanceR3YtdStatusInProcess =
  createChartFinanceYtdStatus(
    financeDataR3YtdWip,
    'ChartFinance-R3StatusInProcess'
  );

const chartFinanceR3YtdStatusNonPerform =
  createChartFinanceYtdStatus(
    financeDataR3YtdWip,
    'ChartFinance-R3StatusNonPerform'
  );

function CreateChartFinanceAllTotalStatus(
  data,
  namaClass
) {
  const pFinanceRThreeTotalPerChart = d3
    .selectAll(`.${namaClass}`)
    .append('svg')
    .attr('width', '450')
    .attr('height', 150);

  const marginFinanceTotalPerChartRThree =
    {
      top: 20,
      right: 0,
      bottom: 20,
      left: 0,
    };
  const graphWidthFinanceTotalPerChartRThree =
    parseInt(
      pFinanceRThreeTotalPerChart.style(
        'width'
      )
    ) -
    marginFinanceTotalPerChartRThree.left -
    marginFinanceTotalPerChartRThree.right;

  const graphHeightFinanceTotalPerChartRThree =
    parseInt(
      pFinanceRThreeTotalPerChart.style(
        'height'
      )
    ) -
    marginFinanceTotalPerChartRThree.top -
    marginFinanceTotalPerChartRThree.bottom;

  //pembuatan group
  const graphFinanceTotalPerChartRThree =
    pFinanceRThreeTotalPerChart
      .append('g')
      .attr(
        'width',
        graphWidthFinanceTotalPerChartRThree
      )
      .attr(
        'height',
        graphHeightFinanceTotalPerChartRThree
      )
      .attr(
        'transform',
        `translate(${marginFinanceTotalPerChartRThree.left},${marginFinanceTotalPerChartRThree.top})`
      );

  const minFinanceTotalPerChartRThree =
    d3.min(data, (d) => d.value); //method untuk mendapatkan nilai terkecil, dg callback function

  const maxFinanceTotalPerChartRThree =
    d3.max(data, (d) => d.value);

  const xAxisGroupFinanceRThreeTotalPerChart =
    graphFinanceTotalPerChartRThree
      .append('g')
      .attr(
        'transform',
        `translate(-1, ${graphHeightFinanceTotalPerChartRThree})`
      )
      .attr('font-weight', 'bolder')
      .attr('color', 'grey');

  //keterangan text dibawah
  const yAxisGroupFinanceRThreeTotalPerChart =
    graphFinanceTotalPerChartRThree.append(
      'g'
    );

  const yFinanceTotalPerChartRThree = d3
    .scaleLinear()
    .domain([
      -5,
      d3.max(data, (d) => d.value),
    ])
    .range([
      graphHeightFinanceTotalPerChartRThree,
      0,
    ]);

  const xFinanceTotalPerChartRThree = d3
    .scaleBand()
    .domain(
      data.map((item) => item.name)
    )
    .range([
      0,
      graphWidthFinanceTotalPerChartRThree,
    ])
    .paddingInner(0.2)
    .paddingOuter(0.2);

  const rectsFinanceTotalPerChartRThree =
    graphFinanceTotalPerChartRThree
      .selectAll('rect')
      .data(data);

  rectsFinanceTotalPerChartRThree
    .attr('width', 65)
    .attr(
      'height',
      (d) =>
        graphHeightFinanceTotalPerChartRThree -
        yFinanceTotalPerChartRThree(
          d.value
        )
    )
    .attr('fill', greenBar)
    .attr('x', (d) =>
      xFinanceTotalPerChartRThree(
        d.name
      )
    )
    .attr('y', (d) =>
      yFinanceTotalPerChartRThree(
        d.value
      )
    );

  rectsFinanceTotalPerChartRThree
    .enter()
    .append('rect')
    .attr('width', 65)
    .attr(
      'height',
      (d) =>
        graphHeightFinanceTotalPerChartRThree -
        yFinanceTotalPerChartRThree(
          d.value
        )
    )
    .attr('fill', greenBar)
    .attr('x', (d) =>
      xFinanceTotalPerChartRThree(
        d.name
      )
    )
    .attr('y', (d) =>
      yFinanceTotalPerChartRThree(
        d.value
      )
    );

  rectsFinanceTotalPerChartRThree
    .enter()
    .append('text')
    .style('font-size', '10px')
    .text((d) => `${d.value}%`)
    .attr('x', (d) =>
      xFinanceTotalPerChartRThree(
        d.name
      )
    )
    .attr(
      'y',
      (d) =>
        yFinanceTotalPerChartRThree(
          d.value
        ) - 5
    )
    .attr(
      'transform',
      `translate(${30},${0})`
    )
    .attr('text-anchor', 'middle');

  //create and call the axes
  const xAxisFinanceTotalPerChartRThree =
    d3.axisBottom(
      xFinanceTotalPerChartRThree
    );

  function wrapTotalPerChartRThree(
    text,
    graphWidthFinanceTotalPerChartRThree
  ) {
    text.each(function () {
      let text = d3.select(this),
        words = text
          .text()
          .split(/\s+/)
          .reverse(),
        word,
        line = [],
        lineNumber = 0,
        lineHeight = 1.1, // ems
        y = text.attr('y'),
        dy = parseFloat(
          text.attr('dy')
        ),
        tspan = text
          .text(null)
          .append('tspan')
          .attr('x', 0)
          .attr('y', y)
          .attr('dy', dy + 'em');
      while ((word = words.pop())) {
        line.push(word);
        tspan.text(line.join(' '));
        if (
          tspan
            .node()
            .getComputedTextLength() >
          graphWidthFinanceTotalPerChartRThree
        ) {
          line.pop();
          tspan.text(line.join(' '));
          line = [word];
          tspan = text
            .append('tspan')
            .attr('x', 0)
            .attr('y', y)
            .attr(
              'dy',
              ++lineNumber *
                lineHeight +
                dy +
                'em'
            )
            .text(word);
        }
      }
    });
  }

  xAxisGroupFinanceRThreeTotalPerChart
    .call(
      xAxisFinanceTotalPerChartRThree
    )
    .selectAll(
      '.ChartFinance-rTwoYtd.tick text'
    )
    .call(
      wrapTotalPerChartRThree,
      xFinanceTotalPerChartRThree.bandwidth()
    ); //call function wrapTotalPerChartRThree

  /* xAxisGroupFinanceRThreeTotalPerChart
  .selectAll("text")
  .attr(
  "transform",
  "rotate(-60) translate(-7, 7)"
  )
  .attr("font-size", 8)
  .attr("text-anchor", "end"); */
  // rotate text axis

  xAxisGroupFinanceRThreeTotalPerChart
    .selectAll('line')
    .remove();

  xAxisGroupFinanceRThreeTotalPerChart
    .select('.domain')
    .remove(); //remove path with class domain
}

const chartFinanceR3StatusAll =
  CreateChartFinanceAllTotalStatus(
    financeDataRthreeStatusTotalPerChart,
    'ChartFinance-R3StatusTotalPerChart'
  );
